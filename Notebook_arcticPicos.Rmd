---
title: "Arctic picos"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r packages}
library(iNEXT)
library(tidyverse)
library(tidyr) 
library(dplyr)
library(ggplot2)
library(vegan)
library(tibble) #for "rownames_to_column('Site')" 
library(geodist)
library(reshape2)
library(UpSetR)
library(ComplexHeatmap)
```

```{r import_data, echo=TRUE, warning=FALSE}
source("C:/Users/choerstm/Documents/Studenten/arctic_picos/Submission/import.R", encoding = "UTF-8")
```

```{r alpha_div, echo=TRUE, fig.width=7,fig.height=3.5, fig.show="hold", out.width="50%"}
source("C:/Users/choerstm/Documents/Studenten/arctic_picos/Submission/alpha_diversity.R")

#the following is very intense comuting so better to not run it too often
#diversity_rarecurve(eukaryotes)
#diversity_rarecurve(prokaryotes)

#load("~/Studenten/arctic_picos/Submission/20210217_rarecurves_calculate.RData")
```
```{r transformations}
source("C:/Users/choerstm/Documents/core_PS113/Genomics/RScripts/general_clr_hellinger_transformation.R")

euk_hellinger <- hellinger(eukaryotes, 1)
prok_hellinger <- hellinger(prokaryotes, 3)

```

```{r nmds, fig.width=5,fig.height=5, fig.show="hold", out.width="50%"}
source("C:/Users/choerstm/Documents/Studenten/arctic_picos/Submission/NMDS.R")

nmds_plot(prok_hellinger, meta_16S)
nmds_plot(euk_hellinger, meta_18S)

###remove outliers for better visualization

outliers <- c("HE533.Euk.F02.04C_S9", "HE533.Euk.F02.08B_S20", "HE533.Euk.F02.08C_S21", "HE533.Euk.F02.09A_S22",
              "HE533.Euk.F02.10A_S25", "HE533.Euk.F02.10C_S27", "HE533.Euk.F02.11A_S28", "HE533.Euk.F02.11C_S30",
              "HE533.Euk.F02.12B_S32", "HE533.Euk.F02.12C_S33", "HE533.Euk.F02.19C_S54", "HE533.Euk.F02.22C_S63")
euk_hellinger_df <- as.data.frame(euk_hellinger)
euk_hellinger_r <- euk_hellinger_df%>%select(!outliers)
meta_18S_r <- meta_18S%>%dplyr::filter(!Site %in% outliers)

nmds_plot(euk_hellinger_r, meta_18S_r)

```
*subsample those fjords where comparison between tip mouth / glacier influence is doable*

```{r}
#eukaryotes
Fjords <- c("Nordvestfjord.Scoresby.Sund","	Van.Mijen.Fjrod", "Woodfjord", "Wijdefjord", "Tanafjord", "Porsangerfjord", "	Nordfjord", "	Sognefjord")

a <- subset(meta_18S, meta_18S["In.Out"] == 1 | meta_18S["In.Out"] == 0)
meta_tip_mouth_18S <- a%>%dplyr::filter(Fjord %in% Fjords)
rownames(meta_tip_mouth_18S) <- meta_tip_mouth_18S$Site

```





